!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.ExtendedTypeChecker={})}(this,function(e){"use strict";function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}var n=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=(e=>(t,r)=>Boolean(t&&e.call(t,r)))(Object.prototype.hasOwnProperty);t.hasOwn=r,t.default=r});t(n);n.hasOwn;var o=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=n)&&"object"==typeof r&&"default"in r?r.default:r;const s="(Arguments)",c="(ReturnValue)";function i(e){if(!(this instanceof i))return new i(e);this.value=e}function p(){return this.value}i.prototype.toString=p,i.prototype.valueOf=p,i.prototype[Symbol.toPrimitive]=p;const a=e=>e.reduce((e,t)=>t instanceof i?`${e}${t}`:String(parseInt(t,10))===t?`${e}[${t}]`:/^[a-z][\w$]*$/i.test(t)?e?`${e}.${t}`:t:`${e}["${t}"]`,""),u=(e,t,r,n,o,s)=>{if(!n)return!0;const c=t[r];if(c){if(c!==n)return o(e,a([...s,r]),c,n),!1}else t[r]=n;return!0},l=({types:e,errorReporter:t},r,n=[])=>{const s=r.types;for(const r in s)if(o(s,r)){const o=s[r],c=e[r];o&&c&&c!==o?t("(Merge)",a([...n,r]),c,o):e[r]=o}return{types:e,errorReporter:t}},y=e=>void 0===e?"":e instanceof Array?"array":typeof e,f=e=>{return function(t,r,n,o,s){const{types:c,errorReporter:i}=o,p=this.getTypeString(n);return u(e,c,r,p,i,s)}},g=f("(GetProperty)"),h=f("(SetProperty)");class d{constructor(){this.collectTypesOnInit=!0,this.getTypeString=y,this.mergeConfigs=l}init(e,t,r=null){let n={};return r?n=r:this.collectTypesOnInit&&Object.keys(e).forEach(t=>{n[t]=y(e[t])}),{types:n,errorReporter:t}}getProperty(e,t,r,n,o){return g.call(this,e,t,r,n,o)}setProperty(e,t,r,n,o){return h.call(this,e,t,r,n,o)}arguments(e,t,r,n,o){const{types:c,errorReporter:i}=n,{length:p}=r;let a=!0;for(let e=0;e<p;e++){const t=this.getTypeString(r[e]);a=u(s,c,String(e),t,i,o)&&a}return a}returnValue(e,t,r,n,o){const{types:s,errorReporter:p}=n,a=this.getTypeString(r);return u(c,s,i(c),a,p,o)}}t.MERGE="(Merge)",t.ARGUMENTS=s,t.GET_PROPERTY="(GetProperty)",t.RETURN_VALUE=c,t.SET_PROPERTY="(SetProperty)",t.buildPath=a,t.AsIs=i,t.checkPrimitiveType=u,t.mergeConfigs=l,t.getTypeString=y,t.propertyCheckerFactory=f,t.PrimitiveTypeChecker=d,t.default=d}),s=t(o),c=(o.MERGE,o.ARGUMENTS),i=o.GET_PROPERTY,p=o.RETURN_VALUE,a=o.SET_PROPERTY,u=(o.buildPath,o.AsIs),l=o.checkPrimitiveType,y=(o.mergeConfigs,o.getTypeString,o.propertyCheckerFactory,o.PrimitiveTypeChecker,r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=n)&&"object"==typeof r&&"default"in r?r.default:r;let s=null;const c=()=>s,i=()=>({wrapFunctionReturnValues:!0,wrapFunctionArguments:!1,wrapSetPropertyValues:!0,ignorePrototypeMethods:!1}),p={wrapFunctionReturnValues:!0,wrapFunctionArguments:!1,wrapSetPropertyValues:!0,ignorePrototypeMethods:!1},a=(e,t=null)=>o(t,e)?t[e]:p[e],u=(e,t,r,n)=>`${e}Error on "${t}" instead of "${r}" received "${n}"`,l=(e,t,r,n)=>console.error(u(e,t,r,n));let y=l;const f=()=>y;let g=!0;const h=()=>g,d=Symbol("type-checkers::info"),T=(e={})=>Object.assign({},e),P=e=>e?e[d]:void 0,R=(e,t)=>{e&&t&&(e[d]=t)},E=e=>!!P(e),O=e=>`@${e}`,m=(e,t,r)=>{const n=O(t);delete e[n],r&&(e[n]=r)},k=(e,t,r)=>{m(e,t,P(r))},C=(e,t)=>e[O(t)],_=(e,t)=>{const{deep:r,checker:n,children:s,config:c,names:i}=e;return n===t.checker?(e.deep=r||t.deep,e.children=((e,t)=>{for(const r in t)o(e,r)?e[r]=_(e[r],t[r]):e[r]=t[r];return e})(s,t.children),e.config=n.mergeConfigs(c,t.config,i)):console.error("TypeChecked objects can be merged only if using exactly same instance of type checker."),e},S=Symbol("type-checkers::target"),b={object:!0,function:!0},x=e=>Boolean(e&&b[typeof e]),I=e=>Boolean(e&&e[S]),w=(e,t,r,n)=>{if(!x(n))return n;let o=n;if(!I(n)){const{children:s}=t,c=C(s,r);if(c)o=e(n,{info:c});else{const{deep:c,names:i,checker:p}=t;o=e(n,{deep:c,names:[...i,r],checker:p}),k(s,r,o)}}return o};let A,V,j;const v=e=>e instanceof Function?(e=>new Proxy(e,{get:A,set:V,apply:j,construct:j}))(e):(e=>new Proxy(e,{get:A,set:V}))(e),F=(e,{deep:t=!0,names:r=[],config:n=null,children:o=null,checker:s=c(),info:i=null}={})=>i||((e,t,r=!0,n=[],o=T())=>({checker:e,config:t,deep:r,names:n,children:o}))(s,s.init(e,f(),n),t,r,T(o)),N=(e,t)=>x(e)&&h()&&!I(e)?(R(e,F(e,t)),v(e)):e;A=(e=>(t,r)=>{const n=t[r];if(r===d)return n;if(r===S)return t;const s=P(t),{names:c,config:i,checker:p}=s;return p.getProperty&&p.getProperty(t,r,n,i,c),!x(n)||I(n)||((e,t,r,n)=>!!(n instanceof Function&&!o(e,r)&&a("ignorePrototypeMethods",t)))(t,s,r,n)?n:((e,t,r,n)=>{const o=P(t),{deep:s,children:c,names:i,checker:p}=o;if(s||n instanceof Function){const t=C(c,r);t?n=e(n,{info:t}):(n=e(n,{deep:s,names:[...i,r],checker:p}),k(c,r,n))}return n})(e,t,r,n)})(N),V=(e=>(t,r,n)=>{if(r===S)throw new Error(`"${S}" is a virtual property and cannot be set`);return((e,t,r)=>{if(t===d){let n=P(e);return n=n&&r&&n!==r?_(n,r):r,e[t]=n,!0}if(!x(r)){const{names:n,config:o,checker:s}=P(e);return s.setProperty&&s.setProperty(e,t,r,o,n),e[t]=r,!0}return!1})(t,r,n)||((e,t,r,n)=>{const o=P(t),{deep:s,names:c,checker:i,config:p,children:u}=o;if(i.setProperty&&i.setProperty(t,r,n,p,c),a("wrapSetPropertyValues",o)){if(!I(n)){const t=C(u,r);n=e(n,t?{info:t}:{deep:s,names:[...c,r],checker:i})}k(u,r,n)}return t[r]=n,!0})(e,t,r,n)})(N),j=(e=>(t,r,n)=>{const o=P(t),{names:s,config:c,checker:i}=o;i.arguments&&i.arguments(t,r,n,c,s),n=((e,t,r)=>{const n=P(t);if(a("wrapFunctionArguments",n)){const{length:t}=r;for(let o=0;o<t;o++)r[o]=w(e,n,String(o),r[o])}return r})(e,t,n);let p=t.apply(r,n);return i.returnValue&&i.returnValue(t,r,p,c,s),a("wrapFunctionReturnValues",o)&&(p=w(e,o,"returnValue",p)),p})(N);const M=(e,t)=>{const r=F(e,t),{deep:n,names:o,checker:s,config:c,children:i}=r;return Object.keys(e).forEach(t=>{const r=e[t];if(s.getProperty(e,t,r,c,o),x(r)){let e=C(i,t);e?M(r,{info:e}):(e=M(r,{deep:n,names:[...o,t],checker:s}),m(i,t,e))}}),R(e,r),r};t.getDefaultTypeChecker=c,t.setDefaultTypeChecker=(e=>{s=e}),t.PROXY_WRAP_FUNCTION_RETURN_VALUES="wrapFunctionReturnValues",t.PROXY_WRAP_FUNCTION_ARGUMENTS="wrapFunctionArguments",t.PROXY_WRAP_SET_PROPERTY_VALUES="wrapSetPropertyValues",t.PROXY_IGNORE_PROTOTYPE_METHODS="ignorePrototypeMethods",t.getDefaultProxyConfig=i,t.setProxyConfig=(e=>Object.assign(p,e)),t.getProxyConfig=(()=>Object.assign({},p)),t.create=N,t.createDeep=((e,t)=>e&&"object"==typeof e&&h()&&!I(e)?(M(e,t),v(e)):e),t.ConsoleErrorReporter=l,t.ConsoleWarnReporter=((e,t,r,n)=>console.warn(u(e,t,r,n))),t.ThrowErrorReporter=((e,t,r,n)=>{throw new Error(u(e,t,r,n))}),t.getErrorReporter=f,t.setErrorReporter=(e=>{y=e}),t.isEnabled=h,t.setEnabled=((e=!0)=>{g=!!e}),t.getTargetInfo=P,t.setTargetInfo=R,t.hasTargetInfo=E,t.getTargetTypeChecker=(e=>{if(e){const t=e[d];return t&&t.checker||void 0}}),t.getTargetTypeCheckerConfig=(e=>{if(e){const t=e[d];return t&&t.config||void 0}}),t.mergeTargetInfo=_,t.getOriginalTarget=(e=>e&&e[S]||e),t.merge=((e,...t)=>{let r={};return h()&&(e||(e={info:P(t.find(e=>E(e))),deep:!1}),r=N(r,e)),Object.assign(r,...t)}),t.properties=((e,t,...r)=>{if(!h())return e;if(!x(e))throw new Error("Target must be a valid object.");if(Object.isFrozen(e)||Object.isSealed(e))throw new Error("Target object should not be sealed or frozen.");r.length||(r=Object.keys(e));const{length:n}=r;for(let o=0;o<n;o+=1){const n=r[o],{writable:s,get:c,set:i}=Object.getOwnPropertyDescriptor(e,n);if(c&&i||s){const r=e[n];x(r)&&!I(r)&&(e[n]=N(r,t))}}return e}),t.isTypeChecked=I,t.isValidTarget=x,t.default=N}));t(y);y.getDefaultTypeChecker,y.setDefaultTypeChecker,y.PROXY_WRAP_FUNCTION_RETURN_VALUES,y.PROXY_WRAP_FUNCTION_ARGUMENTS,y.PROXY_WRAP_SET_PROPERTY_VALUES,y.PROXY_IGNORE_PROTOTYPE_METHODS,y.getDefaultProxyConfig,y.setProxyConfig,y.getProxyConfig,y.create,y.createDeep,y.ConsoleErrorReporter,y.ConsoleWarnReporter,y.ThrowErrorReporter,y.getErrorReporter,y.setErrorReporter,y.isEnabled,y.setEnabled,y.getTargetInfo,y.setTargetInfo,y.hasTargetInfo;var f=y.getTargetTypeChecker,g=y.getTargetTypeCheckerConfig;y.mergeTargetInfo,y.getOriginalTarget,y.merge,y.properties,y.isTypeChecked,y.isValidTarget;const h=[Array],d="(Index)",T=e=>e&&h.indexOf(e.constructor)>=0,P=e=>{h.push(e)},R=(e,t)=>{const r=g(e);r&&(r.types[d]=t||"")},E=(e,t)=>{R(e,f(e).getTypeString(t))},O=(e,t,r)=>{const{types:n}=g(e);delete n[t],r&&(n[t]=r)},m=(e,t)=>{const{types:r}=g(e);delete r[c],t&&(r[c]=t)},k=(e,t)=>{const{types:r}=g(e);delete r[p],t&&(r[p]=t)},C=(e,t)=>{const{types:r}=g(e);delete r[d],t&&(r[d]=t)};class _ extends s{constructor(...e){var t;return t=super(...e),this.areArrayElementsOfSameType=!0,this.replacePropertyTypeCheck=O,this.replaceArgumentsTypeCheck=m,this.replaceReturnValueTypeCheck=k,this.replaceIndexedTypeCheck=C,this.isIndexAccessTarget=T,this.registerIndexBasedClass=P,this.setIndexValueType=R,this.setIndexValueTypeBy=E,t}init(e,t,r=null){const n={};if(r||!this.collectTypesOnInit||!this.areArrayElementsOfSameType||!T(e))return super.init(e,t,r);{const{length:t}=e;for(let r=0;r<t;r+=1){const t=this.getTypeString(e[r]);if(t){n[d]=t;break}}}return{types:n,errorReporter:t}}getProperty(e,t,r,n,o){return this.areArrayElementsOfSameType&&T(e)?this.getIndexProperty(e,d,r,n,o):this.getNamedProperty(e,t,r,n,o)}getIndexProperty(e,t,r,n,o){const{types:s,errorReporter:c}=n,p=s[t];if(p instanceof Function)return p(i,e,t,r,n,o);const a=this.getTypeString(r);return l(i,s,u(d),a,c,o)}getNamedProperty(e,t,r,n,o){const s=n.types[t];return s instanceof Function?s(i,e,t,r,n,o):super.getProperty(e,t,r,n,o)}setProperty(e,t,r,n,o){return this.areArrayElementsOfSameType&&T(e)?this.setIndexProperty(e,d,r,n,o):this.setNamedProperty(e,t,r,n,o)}setIndexProperty(e,t,r,n,o){const{types:s,errorReporter:c}=n,i=s[t];if(i instanceof Function)return i(a,e,t,r,n,o);const p=this.getTypeString(r);return l(a,s,u(d),p,c,o)}setNamedProperty(e,t,r,n,o){const s=n.types[t];return s instanceof Function?s(a,e,t,r,n,o):super.setProperty(e,t,r,n,o)}arguments(e,t,r,n,o){const s=n.types[c];return s instanceof Function?s(c,e,r,n,o):super.arguments(e,t,r,n,o)}returnValue(e,t,r,n,o){const s=n.types[p];return s instanceof Function?s(p,e,r,n,o):super.returnValue(e,t,r,n,o)}}var S=Object.freeze({isIndexAccessTarget:T,registerIndexBasedClass:P,setIndexValueType:R,setIndexValueTypeBy:E,replaceArgumentsTypeCheck:m,replaceIndexedTypeCheck:C,replacePropertyTypeCheck:O,replaceReturnValueTypeCheck:k,ExtendedTypeChecker:_,default:_}),b=S&&_||S,x=r(function(e,t){y.setDefaultTypeChecker(new b.ExtendedTypeChecker),Object.assign(t,o,b,y)});e.default=x,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=extended-type-checker.min.js.map
