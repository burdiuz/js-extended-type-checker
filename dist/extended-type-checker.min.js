!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@actualwave/type-checkers")):"function"==typeof define&&define.amd?define(["exports","@actualwave/type-checkers"],t):t(e.ExtendedTypeChecker={},e.TypeCheckers)}(this,function(e,t){"use strict";function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,t){return e(t={exports:{}},t.exports),t.exports}var s=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=(e,t,r,o)=>`${e}Error on "${t}" instead of "${r}" received "${o}"`;t.ConsoleErrorReporter=((e,t,o,s)=>console.error(r(e,t,o,s))),t.ConsoleWarnReporter=((e,t,o,s)=>console.warn(r(e,t,o,s))),t.ThrowErrorReporter=((e,t,o,s)=>{throw new Error(r(e,t,o,s))})});r(s);s.ConsoleErrorReporter,s.ConsoleWarnReporter,s.ThrowErrorReporter;var n=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=(e=>(t,r)=>Boolean(t&&e.call(t,r)))(Object.prototype.hasOwnProperty);t.hasOwn=r,t.default=r});r(n);n.hasOwn;var a=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.storage=new Map}has(e){const t=this.storage.get(e);return t&&t.size}hasValue(e,t){const r=this.storage.get(e);return r&&r.has(t)}get(e){return this.storage.get(e)}list(e){const t=this.storage.get(e);return t?Array.from(t):[]}forEach(e){this.storage.forEach((t,r)=>t.forEach(t=>e(t,r,this)))}eachValue(e,t){const r=this.storage.get(e);r&&r.forEach(r=>t(r,e,this))}add(e,t){if(!t)return;const r=this.storage.get(e);r?r.add(t):this.storage.set(e,new Set([t]))}set(e,t){t&&0!==t.size?this.storage.set(e,new Set(t)):this.remove(e)}remove(e){this.storage.delete(e)}removeValue(e,t){const r=this.storage.get(e);r&&(r.delete(t),r.size||this.remove(e))}clone(){const e=new r;return this.storage.forEach((t,r)=>e.set(r,new Set(t))),e}}t.MapOfSets=r,t.createMapOfSets=(()=>new r),t.default=r});r(a);a.MapOfSets,a.createMapOfSets;var l=o(function(e,t){function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n),s=r(a);const l="never",c="once",i="all",p=Symbol("type-checkers:report-level"),u=Symbol("type-checkers:property-report-level");let h=i;const y=e=>{switch(e){case l:case c:return e;default:return i}},R=()=>h,g=(e,t)=>o(e[u],t)?e[u][t]:e[p],T=(e,t)=>{let r=g(e,t);return r||(r=g(e.constructor,t)),r||R()},d=(e,t,r)=>(r.forEach(e=>{t.has(e)||t.add(e)}),t);class E extends s{add(e,t,r){if(t)switch(r){case l:this.remove(e);break;case c:super.add(e,t);break;case i:default:{const r=this.storage.get(e);r&&r.size||this.storage.set(e,new Set([t]))}}}addFor(e,t,r){this.add(e,t,T(r,e))}set(e,t,r){t&&0!==t.size&&r!==l?super.set(e,t):this.remove(e)}setFor(e,t,r){return this.set(e,t,T(r,e))}clone(){const e=new E;return this.storage.forEach((t,r)=>e.set(r,new Set(t))),e}copyTo(e,t,r=d){return this.storage.forEach((o,s)=>{const n=y(t&&T(t,s));switch(n){case i:case c:e.has(s)?e.set(s,r(s,e.get(s),o,n),n):e.set(s,new Set(o))}}),e}}t.REPORT_ALL=i,t.REPORT_NEVER=l,t.REPORT_ONCE=c,t.createTypesStorage=(()=>new E),t.defaultMergeStrategy=d,t.getGlobalReportingLevel=R,t.setGlobalReportingLevel=(e=>{h=y(e)}),t.getReportingLevel=T,t.setReportingLevel=((e,t,r)=>{((e,t)=>{t?e[p]=y(t):delete e[p]})(e,t),((e,t)=>{t?e[u]=Object.keys(t).reduce((e,r)=>(e[r]=y(t[r]),e),{}):delete e[u]})(e,r)})});r(l);l.REPORT_ALL,l.REPORT_NEVER,l.REPORT_ONCE;var c=l.createTypesStorage,i=(l.defaultMergeStrategy,l.getGlobalReportingLevel,l.setGlobalReportingLevel,l.getReportingLevel,l.setReportingLevel,o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});let r=s.ConsoleErrorReporter;const o=()=>r,n="(Merge)",a="(GetProperty)",c="(SetProperty)",i="(Arguments)",p="(ReturnValue)",u=(e,t,r)=>!e.has(t)||e.hasValue(t,r),h=e=>{if(void 0===e)return"";const t=typeof e;return"object"===t&&e instanceof Array?"array":t};class y{constructor(e=!0,t=!0){this.collectTypesOnInit=e,this.enableGetChecker=t}init(e,t=null){let r;return t?r=t:this.collectTypesOnInit&&(r=l.createTypesStorage(),Object.keys(e).forEach(t=>r.addFor(t,this.getTypeValue(e[t]),e))),r}getTypeValue(e){return h(e)}checkValueType(e,t,r,s,n){if(!n)return!0;const{lastName:a}=s,l=this.isTypeCompatible(t,a,n,r);if(!l){o()(e,s.toString(),t.list(a),n)}return t.addFor(a,n,r),l}isTypeCompatible(e,t,r){return u(e,t,r)}mergeConfigs(e,t,r){const s=o();t.copyTo(e,null,(e,t,o)=>{const a=t.values().next().value;return o.forEach(e=>{t.has(e)||(t.add(e),a&&s(n,r,a,e))}),t})}getProperty(e,t,r,o){if(!this.enableGetChecker)return!0;const s=this.getTypeValue(r);return this.checkValueType(a,o,e,t,s)}setProperty(e,t,r,o){const s=this.getTypeValue(r);return this.checkValueType(c,o,e,t,s)}arguments(e,t,r,o){const{length:s}=r;let n=!0;for(let a=0;a<s;a++){const s=this.getTypeValue(r[a]);n=this.checkValueType(i,o,e,t.clone(a),s)&&n}return n}returnValue(e,t,r,o){const s=this.getTypeValue(r),n=t.clone();return n.appendCustomValue(p),this.checkValueType(p,o,e,n,s)}}t.REPORT_ALL=l.REPORT_ALL,t.REPORT_NEVER=l.REPORT_NEVER,t.REPORT_ONCE=l.REPORT_ONCE,t.getGlobalReportingLevel=l.getGlobalReportingLevel,t.setGlobalReportingLevel=l.setGlobalReportingLevel,t.getReportingLevel=l.getReportingLevel,t.setReportingLevel=l.setReportingLevel,t.MERGE=n,t.ARGUMENTS=i,t.GET_PROPERTY=a,t.RETURN_VALUE=p,t.SET_PROPERTY=c,t.checkPrimitiveType=u,t.getTypeValue=h,t.PrimitiveTypeChecker=y,t.createPrimitiveTypeChecker=((e=!0,t=!0)=>new y(e,t)),t.getErrorReporter=o,t.setErrorReporter=(e=>{r=e}),t.default=y})),p=r(i),u=i.REPORT_ALL,h=i.REPORT_NEVER,y=i.REPORT_ONCE,R=i.getGlobalReportingLevel,g=i.setGlobalReportingLevel,T=i.getReportingLevel,d=i.setReportingLevel,E=i.MERGE,f=i.ARGUMENTS,v=i.GET_PROPERTY,O=i.RETURN_VALUE,P=i.SET_PROPERTY,m=(i.checkPrimitiveType,i.getTypeValue),_=(i.PrimitiveTypeChecker,i.createPrimitiveTypeChecker,i.getErrorReporter),b=i.setErrorReporter,C=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=e=>{const t=Object.getPrototypeOf(e);return t&&"object"==typeof t?t.constructor:t||Object},o=e=>{if(null==e)return;const t=e.constructor;return"function"==typeof t&&e instanceof t?e.constructor:r(e)};t.getClassName=(e=>{if(!e)return"";const t=o(e);return t?t.name:""}),t.getParentClass=(e=>r(o(e))),t.getClass=o,t.default=o});r(C);C.getClassName,C.getParentClass;var V=C.getClass;const L=new Set([Array]),S="(Index)",w=e=>!!e&&L.has(V(e)),k=(e,r)=>{const o=t.getTypeCheckerData(e);o&&r&&o.set(S,new Set([r]))};var G=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=e=>"function"==typeof e;t.isFunction=r,t.default=r}),x=r(G);G.isFunction;const M=(e,t)=>{if(void 0!==e&&!x(e))throw new Error(`"${t}" must be a callable object, i.e. function.`)};class A extends p{constructor({collectTypesOnInit:e=!0,enableGetChecker:t=!0,areArrayElementsOfSameType:r=!0,customTypeResolver:o,customTypeComparator:s}={}){super(e,t),this.areArrayElementsOfSameType=r,this.customTypeResolver=o,M(this.customTypeResolver,"customTypeResolver"),this.customTypeComparator=s,M(this.customTypeComparator,"customTypeComparator")}getTypeValue(e){return this.customTypeResolver?this.customTypeResolver(e):super.getTypeValue(e)}isTypeCompatible(e,t,r,o){return this.customTypeComparator?this.customTypeComparator(e,t,r,o):super.isTypeCompatible(e,t,r,o)}findIndexedType(e){const{length:t}=e;for(let r=0;r<t;r+=1){const t=this.getTypeValue(e[r]);if(t)return t}return""}init(e,t=null){if(!t&&this.collectTypesOnInit&&this.areArrayElementsOfSameType&&w(e)){const t=c(),r=this.findIndexedType(e);if(r)return t.add(S,r),t}return super.init(e,t)}getProperty(e,t,r,o){return this.areArrayElementsOfSameType&&w(e)?this.getIndexProperty(e,t,r,o):super.getProperty(e,t,r,o)}getIndexProperty(e,t,r,o){const s=t.clone();return s.appendCustomValue(S),this.checkValueType(v,o,e,s,this.getTypeValue(r))}setProperty(e,t,r,o){return this.areArrayElementsOfSameType&&w(e)?this.setIndexProperty(e,t,r,o):super.setProperty(e,t,r,o)}setIndexProperty(e,t,r,o){const s=t.clone();return s.appendCustomValue(S),this.checkValueType(P,o,e,s,this.getTypeValue(r))}}e.INDEX=S,e.isIndexAccessTarget=w,e.registerIndexBasedClass=(e=>{L.add(e)}),e.setIndexValueType=k,e.setIndexValueTypeBy=((e,t)=>{k(e,m(t))}),e.ExtendedTypeChecker=A,e.createExtendedTypeChecker=(e=>new A(e)),e.MERGE=E,e.ARGUMENTS=f,e.GET_PROPERTY=v,e.RETURN_VALUE=O,e.SET_PROPERTY=P,e.getErrorReporter=_,e.setErrorReporter=b,e.REPORT_ALL=u,e.REPORT_NEVER=h,e.REPORT_ONCE=y,e.getGlobalReportingLevel=R,e.setGlobalReportingLevel=g,e.getReportingLevel=T,e.setReportingLevel=d,e.default=A,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=extended-type-checker.min.js.map
