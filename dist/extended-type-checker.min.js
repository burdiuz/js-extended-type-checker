!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.ExtendedTypeChecker={})}(this,function(e){"use strict";function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}var n=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=(e,t,r,n)=>`${e}Error on "${t}" instead of "${r}" received "${n}"`;t.ConsoleErrorReporter=((e,t,n,s)=>console.error(r(e,t,n,s))),t.ConsoleWarnReporter=((e,t,n,s)=>console.warn(r(e,t,n,s))),t.ThrowErrorReporter=((e,t,n,s)=>{throw new Error(r(e,t,n,s))})});t(n);n.ConsoleErrorReporter,n.ConsoleWarnReporter,n.ThrowErrorReporter;var s=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=(e=>(t,r)=>Boolean(t&&e.call(t,r)))(Object.prototype.hasOwnProperty);t.hasOwn=r,t.default=r});t(s);s.hasOwn;var o=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.storage=new Map}has(e){const t=this.storage.get(e);return t&&t.size}hasValue(e,t){const r=this.storage.get(e);return r&&r.has(t)}get(e){return this.storage.get(e)}list(e){const t=this.storage.get(e);return t?Array.from(t):[]}forEach(e){this.storage.forEach((t,r)=>t.forEach(t=>e(t,r,this)))}eachValue(e,t){const r=this.storage.get(e);r&&r.forEach(r=>t(r,e,this))}add(e,t){if(!t)return;const r=this.storage.get(e);r?r.add(t):this.storage.set(e,new Set([t]))}set(e,t){t&&0!==t.size?this.storage.set(e,new Set(t)):this.remove(e)}remove(e){this.storage.delete(e)}removeValue(e,t){const r=this.storage.get(e);r&&(r.delete(t),r.size||this.remove(e))}clone(){const e=new r;return this.storage.forEach((t,r)=>e.set(r,new Set(t))),e}}t.MapOfSets=r,t.createMapOfSets=(()=>new r),t.default=r});t(o);o.MapOfSets,o.createMapOfSets;var a=r(function(e,t){function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var n=r(s),a=r(o);const c="never",l="once",i="all",u=Symbol("type-checkers:report-level"),p=Symbol("type-checkers:property-report-level");let h=i;const d=e=>{switch(e){case c:case l:return e;default:return i}},g=()=>h,y=(e,t)=>n(e[p],t)?e[p][t]:e[u],f=(e,t)=>{let r=y(e,t);return r||(r=y(e.constructor,t)),r||g()},R=(e,t,r)=>(r.forEach(e=>{t.has(e)||t.add(e)}),t);class T extends a{add(e,t,r){if(t)switch(r){case c:this.remove(e);break;case l:super.add(e,t);break;case i:default:{const r=this.storage.get(e);r&&r.size||this.storage.set(e,new Set([t]))}}}addFor(e,t,r){this.add(e,t,f(r,e))}set(e,t,r){t&&0!==t.size&&r!==c?super.set(e,t):this.remove(e)}setFor(e,t,r){return this.set(e,t,f(r,e))}clone(){const e=new T;return this.storage.forEach((t,r)=>e.set(r,new Set(t))),e}copyTo(e,t,r=R){return this.storage.forEach((n,s)=>{const o=d(t&&f(t,s));switch(o){case i:case l:e.has(s)?e.set(s,r(s,e.get(s),n,o),o):e.set(s,new Set(n))}}),e}}t.REPORT_ALL=i,t.REPORT_NEVER=c,t.REPORT_ONCE=l,t.createTypesStorage=(()=>new T),t.defaultMergeStrategy=R,t.getGlobalReportingLevel=g,t.setGlobalReportingLevel=(e=>{h=d(e)}),t.getReportingLevel=f,t.setReportingLevel=((e,t,r)=>{((e,t)=>{t?e[u]=d(t):delete e[u]})(e,t),((e,t)=>{t?e[p]=Object.keys(t).reduce((e,r)=>(e[r]=d(t[r]),e),{}):delete e[p]})(e,r)})});t(a);a.REPORT_ALL,a.REPORT_NEVER,a.REPORT_ONCE;var c=a.createTypesStorage,l=(a.defaultMergeStrategy,a.getGlobalReportingLevel,a.setGlobalReportingLevel,a.getReportingLevel,a.setReportingLevel,r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});let r=n.ConsoleErrorReporter;const s=()=>r,o="(Merge)",c="(GetProperty)",l="(SetProperty)",i="(Arguments)",u="(ReturnValue)",p=(e,t,r,n,o)=>{if(!o)return!0;const{lastName:a}=n,c=t.has(a)&&!t.hasValue(a,o);if(c){s()(e,n.toString(),t.list(a).join(", "),o)}return t.addFor(a,o,r),!c},h=e=>{if(void 0===e)return"";const t=typeof e;return"object"===t&&e instanceof Array?"array":t};class d{constructor(e=!0,t=!0){this.collectTypesOnInit=e,this.enableGetChecker=t}init(e,t=null){let r;return t?r=t:this.collectTypesOnInit&&(r=a.createTypesStorage(),Object.keys(e).forEach(t=>r.addFor(t,this.getTypeValue(e[t]),e))),r}getTypeValue(e){return h(e)}checkType(e,t,r,n,s){return p(e,t,r,n,s)}mergeConfigs(e,t,r){const n=s();t.copyTo(e,null,(e,t,s)=>{const a=t.values().next().value;return s.forEach(e=>{t.has(e)||(t.add(e),a&&n(o,r,a,e))}),t})}getProperty(e,t,r,n){if(!this.enableGetChecker)return!0;const s=this.getTypeValue(r);return this.checkType(c,n,e,t,s)}setProperty(e,t,r,n){const s=this.getTypeValue(r);return this.checkType(l,n,e,t,s)}arguments(e,t,r,n){const{length:s}=r;let o=!0;for(let a=0;a<s;a++){const s=this.getTypeValue(r[a]);o=this.checkType(i,n,e,t.clone(a),s)&&o}return o}returnValue(e,t,r,n){const s=this.getTypeValue(r),o=t.clone();return o.appendCustomValue(u),this.checkType(u,n,e,o,s)}}t.REPORT_ALL=a.REPORT_ALL,t.REPORT_NEVER=a.REPORT_NEVER,t.REPORT_ONCE=a.REPORT_ONCE,t.getGlobalReportingLevel=a.getGlobalReportingLevel,t.setGlobalReportingLevel=a.setGlobalReportingLevel,t.getReportingLevel=a.getReportingLevel,t.setReportingLevel=a.setReportingLevel,t.MERGE=o,t.ARGUMENTS=i,t.GET_PROPERTY=c,t.RETURN_VALUE=u,t.SET_PROPERTY=l,t.checkPrimitiveType=p,t.getTypeValue=h,t.PrimitiveTypeChecker=d,t.createPrimitiveTypeChecker=((e=!0,t=!0)=>new d(e,t)),t.getErrorReporter=s,t.setErrorReporter=(e=>{r=e})})),i=t(l),u=l.REPORT_ALL,p=l.REPORT_NEVER,h=l.REPORT_ONCE,d=l.getGlobalReportingLevel,g=l.setGlobalReportingLevel,y=l.getReportingLevel,f=l.setReportingLevel,R=l.MERGE,T=l.ARGUMENTS,E=l.GET_PROPERTY,v=l.RETURN_VALUE,m=l.SET_PROPERTY,P=(l.checkPrimitiveType,l.getTypeValue),O=(l.PrimitiveTypeChecker,l.createPrimitiveTypeChecker,l.getErrorReporter),w=l.setErrorReporter,C=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=e=>{if(null==e)return;const t=Object.getPrototypeOf(e);return"object"==typeof t?t.constructor:t};t.getClassName=(e=>{if(!e)return"";const t=String(r(e)).match(/^(?:[^\(\{\s]*)(?:class|function)\s+([\w\d_$]+)(?:\s*\(|\s*\{|\s+extends)/);return t?t[1]:""}),t.getParentClass=(e=>{const t=r(e);return t&&Object.getPrototypeOf(t)}),t.getClass=r,t.default=r});t(C);C.getClassName,C.getParentClass;var b=C.getClass,V=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.singleValueFactory=((e=null,t=(e=>e))=>{let r=e;return{getDefault:()=>e,get:()=>r,set:(n=e)=>{r=t(n)}}}),t.valuesMapFactory=((e=new Map,t=((e,t)=>t))=>{const r=new Map(e),n=()=>new Map(r),s=n();return{values:s,getDefault:n,copy:()=>new Map(s),delete:e=>s.delete(e),has:e=>s.has(e),set:(e,r)=>s.set(e,t(e,r)),get:e=>s.get(e)}}),t.valuesSetFactory=((e=new Set,t=(e=>e))=>{const r=new Set(e),n=()=>new Set(r),s=n();return{values:s,getDefault:n,get:()=>new Set(s),delete:e=>s.delete(e),has:e=>s.has(e),add:e=>s.add(t(e))}})});t(V);V.singleValueFactory,V.valuesMapFactory,V.valuesSetFactory;var S=r(function(e,t){function r(e){if(!(this instanceof r))return new r(e);this.value=e}function n(){return this.value}Object.defineProperty(t,"__esModule",{value:!0}),r.prototype.toString=n,r.prototype.valueOf=n,r.prototype[Symbol.toPrimitive]=n;const s=(e,t)=>{const n=String(e)||"";return t instanceof r?`${n}${t}`:"symbol"==typeof t?`${n}[${String(t)}]`:String(parseInt(t,10))===t?`${n}[${t}]`:/^[a-z_$][\w\d$_]*$/i.test(t)?n?`${n}.${t}`:t:`${n}["${t}"]`};class o{constructor(e){this.value=e?String(e):"",this.lastName=void 0}append(e){this.value=s(this.value,e),this.lastName=e}appendCustomValue(e){this.value=s(this.value,r(e)),this.lastName=e}clone(e){const t=new o(this.value);return void 0===e?t.lastName=this.lastName:t.append(e),t}getLastName(){return this.lastName}toString(){return this.value}valueOf(){return this.value}}t.createPathSequence=(e=>new o(e)),t.default=o});t(S);S.createPathSequence;var _=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=e=>"function"==typeof e;t.isFunction=r,t.default=r}),k=t(_),L=(_.isFunction,r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const{isFunction:r}=_,n=e=>{const{apply:t,construct:n}=e;delete e.apply,delete e.construct;const s={...e,construct:n,apply:t};return t=>new Proxy(t,r(t)?s:e)};t.withProxy=n,t.default=n}));t(L);L.withProxy;var N=r(function(e,t){function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var n=r(s),o=r(_),a=r(L);const{get:c,set:l}=V.singleValueFactory(),{get:i,set:u}=V.singleValueFactory(!0,e=>!!e),p=new Set,h=(...e)=>{e.forEach(e=>{e&&!p.has(e)&&p.add(e)})},d=e=>p.has(C.getClass(e));h(Map,Set,Date,Error);const{getDefault:g,set:y,get:f}=V.valuesMapFactory([["wrapFunctionReturnValues",!0],["wrapFunctionArguments",!1],["wrapSetPropertyValues",!1],["ignorePrototypeMethods",!1]],(e,t)=>!!t),R=(e,t)=>{let r;return t&&(r=t[e]),void 0===r?f(e):r},T=e=>`@${String(e)}`;class E{constructor(e){this.cache=e?{...e.cache}:{}}store(e,t){const r=T(e);t?this.cache[r]=t:delete this.cache[r]}get(e){return this.cache[T(e)]}has(e){return!!this.cache[T(e)]}remove(e,t){return delete this.cache[T(t)]}copy({cache:e}){return Object.keys(e).forEach(t=>{n(this.cache,t)?this.cache[t].copy(e[t]):this.cache[t]=e[t]}),this}}const v=e=>new E(e),m=Symbol("type-checkers::info"),P=e=>e?e[m]:void 0,O=(e,t)=>{e&&t&&(e[m]=t)};class w{constructor(e,t=null,r=!0,n=S.createPathSequence(),s=v()){this.checker=e,this.data=t,this.deep=r,this.names=n,this.children=s}getChild(e){return this.children.get(e)}storeChildFrom(e,t){const r=P(t);r&&this.children.store(e,r)}createChildWithNames(e,t,r=null){const n=new w(this.checker,this.checker.init(t,r),this.deep,e);return this.children.store(e.lastName,n),n}createChild(e,t,r=null){return this.createChildWithNames(this.names.clone(e),t,r)}copy({deep:e,checker:t,children:r,data:n,names:s}){return this.checker===t?(this.deep=this.deep||e,this.children.copy(r),this.data=t.mergeConfigs(this.data,n,s)):console.error("TypeChecked objects can be merged only if using exactly same instance of type checker."),this}}const b=Symbol("type-checkers::target"),k=e=>"symbol"==typeof e,N=e=>Boolean(e&&e[b]),M=e=>(e=>{const t=typeof e;return Boolean(e)&&("function"===t||"object"===t)&&!d(e)})(e)&&!N(e),j=e=>(t,r)=>{const s=t[r];if(r===m)return s;if(r===b)return t;if(k(r))return t[r];const a=P(t),{names:c,data:l,checker:i}=a,u=c.clone(r);return i.getProperty&&i.getProperty(t,u,s,l),!M(s)||((e,t,r,s)=>!(!o(s)||n(e,r)||!R("ignorePrototypeMethods",t)))(t,a,r,s)?s:((e,t,r,n)=>{const s=P(t),{deep:a}=s;if(a||o(n)){const{lastName:t}=r,o=s.getChild(t);return e(n,o||s.createChildWithNames(r,n))}return n})(e,t,u,s)},G=(e,t)=>{let r=P(e);return r&&t&&r!==t?r.copy(t):r=t,e[m]=r,!0},I=e=>(t,r,n)=>{if(r===b)throw new Error(`"${b}" is a virtual property and cannot be set`);if(r===m)return G(t,n);if(k(r))return G(t,n);const s=P(t);return M(n)&&R("wrapSetPropertyValues",s)?((e,t,r,n)=>{const s=P(t),{names:o,checker:a,data:c}=s,l=s.getChild(r),i=l?l.names:o.clone(r);return a.setProperty&&a.setProperty(t,i,n,c),n=e(n,l||s.createChildWithNames(i,n)),t[r]=n,!0})(e,t,r,n):((e,t,r)=>{const{names:n,data:s,checker:o}=P(e);return o.setProperty&&o.setProperty(e,n.clone(t),r,s),e[t]=r,!0})(t,r,n)},x=(e,t,r,n)=>{if(!M(n))return n;const s=t.getChild(r);return e(n,s||t.createChild(r,n))},A=(e,t,r)=>{if(R("wrapFunctionArguments",t)){const{length:n}=r;for(let s=0;s<n;s++)r[s]=x(e,t,String(s),r[s])}return r},F=(e,{checker:t=c(),deep:r,name:n,data:s,children:o,info:a=null}={})=>a||((e,t,r,n,s)=>new w(e,t,r,n,s))(t,t.init(e,s),r,S.createPathSequence(n),o),$=(e,t=null)=>({get:(!t||t.get)&&j(e),set:(!t||t.set)&&I(e),apply:(!t||t.apply)&&(e=>(t,r,n)=>{const s=P(t),{names:o,data:a,checker:c}=s;c.arguments&&c.arguments(t,o,n,a,r),R("wrapFunctionArguments",s)&&(n=A(e,s,n));let l=t.apply(r,n);return c.returnValue&&c.returnValue(t,o,l,a,r),R("wrapFunctionReturnValues",s)&&(l=x(e,s,"returnValue",l)),l})(e),construct:(!t||t.construct)&&(e=>(t,r)=>{const n=P(t),{names:s,data:o,checker:a}=n;a.arguments&&a.arguments(t,s,r,o),R("wrapFunctionArguments",n)&&(r=A(e,n,r));let c=new t(...r);return a.returnValue&&a.returnValue(t,s,c,o),R("wrapFunctionReturnValues",n)&&(c=x(e,n,"returnValue",c)),c})(e),deleteProperty:(!t||t.deleteProperty)&&(()=>(e,t)=>{if(t===m)return delete e[t];if(t===b)return!1;if(k(t))return delete e[t];const r=P(e),{names:n,data:s,checker:o}=r;return o.deleteProperty(e,n.clone(t),s),delete e[t]})()}),W=e=>{let t;const r=(e,r)=>(O(e,r),t(e)),n=$(r,e);return t=a(n),r},D=(e,t=null,r=null)=>{if(!M(e)||!i())return e;return W(r)(e,F(e,t||void 0))},U=(e,t)=>{const{names:r,checker:n,data:s}=t;return Object.keys(e).forEach(o=>{const a=e[o],c=r.clone(o);if(n.getProperty&&n.getProperty(e,c,a,s),M(a)){let e=t.getChild(o);e||(e=t.createChildWithNames(c,a)),U(a,e)}}),O(e,t),t},z=e=>e.find(N),Y=(...e)=>{const t=z(e);if(!t)return Object.assign({},...e);const r=P(t);return Object.assign(D({},{info:r}),...e)};Y.options=((e,...t)=>Y(D({},e),...t));const B=(e,...t)=>{if(N(e))return Object.assign(e,...t);const r=z(t);if(!r)return Object.assign(e,...t);const n=P(r);return Object.assign(D(e,{info:n}),...t)};B.options=((e,t,...r)=>B(D(t,e),...r)),t.getDefaultTypeChecker=c,t.setDefaultTypeChecker=l,t.isEnabled=i,t.setEnabled=u,t.addIgnoredClasses=h,t.isIgnoredClass=(e=>p.has(e)),t.isValueOfIgnoredClass=d,t.removeIgnoredClasses=((...e)=>{e.forEach(e=>p.delete(e))}),t.setWrapConfigValue=y,t.getWrapConfigValue=R,t.getTargetInfo=P,t.getTypeChecker=(e=>{if(e){const t=e[m];return t&&t.checker||void 0}}),t.getTypeCheckerData=(e=>{if(e){const t=e[m];return t&&t.data||void 0}}),t.removeTargetInfo=(e=>delete e[m]),t.wrap=D,t.wrapDeep=((e,t,r=null)=>{if(!M(e)||"object"!=typeof e||!i())return e;const n=W(r),s=F(e,t);return U(e,s),n(e,s)}),t.isWrappable=M,t.isWrapped=N,t.unwrap=(e=>e&&e[b]||e),t.setWrapConfigTo=((e,t,r)=>{if(!N(e))return!1;const n=P(e);switch(t){case"wrapFunctionReturnValues":case"wrapFunctionArguments":case"wrapSetPropertyValues":case"ignorePrototypeMethods":return n[t]=!!r,!0;default:return!1}}),t.assign=B,t.merge=Y});t(N);N.getDefaultTypeChecker,N.setDefaultTypeChecker,N.isEnabled,N.setEnabled,N.addIgnoredClasses,N.isIgnoredClass,N.isValueOfIgnoredClass,N.removeIgnoredClasses,N.setWrapConfigValue,N.getWrapConfigValue,N.getTargetInfo,N.getTypeChecker;var M=N.getTypeCheckerData;N.removeTargetInfo,N.wrap,N.wrapDeep,N.isWrappable,N.isWrapped,N.unwrap,N.setWrapConfigTo,N.assign,N.merge;const j=new Set([Array]),G="(Index)",I=e=>!!e&&j.has(b(e)),x=(e,t)=>{const r=M(e);r&&t&&r.set(G,new Set([t]))};class A extends i{constructor({collectTypesOnInit:e=!0,enableGetChecker:t=!0,areArrayElementsOfSameType:r=!0,customGetTypeValue:n}={}){if(super(e,t),this.setNamedProperty=((e,t,r,n)=>super.setProperty(e,t,r,n)),this.areArrayElementsOfSameType=r,this.customGetTypeValue=n,void 0!==this.customGetTypeValue&&!k(this.customGetTypeValue))throw new Error('"customGetTypeValue" must be a callable object, i.e. function.')}getTypeValue(e){return this.customGetTypeValue?this.customGetTypeValue(e):super.getTypeValue(e)}findIndexedType(e){const{length:t}=e;for(let r=0;r<t;r+=1){const t=this.getTypeValue(e[r]);if(t)return t}return""}init(e,t=null){if(!t&&this.collectTypesOnInit&&this.areArrayElementsOfSameType&&I(e)){const t=c(),r=this.findIndexedType(e);if(r)return t.add(G,r),t}return super.init(e,t)}getProperty(e,t,r,n){return this.areArrayElementsOfSameType&&I(e)?this.getIndexProperty(e,t,r,n):this.getNamedProperty(e,t,r,n)}getIndexProperty(e,t,r,n){return this.checkType(E,e,t.clone(G),this.getTypeValue(r),n)}getNamedProperty(e,t,r,n){return super.getProperty(e,t,r,n)}setProperty(e,t,r,n){return this.areArrayElementsOfSameType&&I(e)?this.setIndexProperty(e,t,r,n):this.setNamedProperty(e,t,r,n)}setIndexProperty(e,t,r,n){const s=this.getTypeValue(r);return this.checkType(m,e,t,s,n)}}e.INDEX=G,e.isIndexAccessTarget=I,e.registerIndexBasedClass=(e=>{j.add(e)}),e.setIndexValueType=x,e.setIndexValueTypeBy=((e,t)=>{x(e,P(t))}),e.ExtendedTypeChecker=A,e.createExtendedTypeChecker=((e=!0,t=!0,r=!0)=>new A(e,t,r)),e.MERGE=R,e.ARGUMENTS=T,e.GET_PROPERTY=E,e.RETURN_VALUE=v,e.SET_PROPERTY=m,e.getErrorReporter=O,e.setErrorReporter=w,e.REPORT_ALL=u,e.REPORT_NEVER=p,e.REPORT_ONCE=h,e.getGlobalReportingLevel=d,e.setGlobalReportingLevel=g,e.getReportingLevel=y,e.setReportingLevel=f,e.default=A,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=extended-type-checker.min.js.map
